<div class="nav">
  <button mat-button [matMenuTriggerFor]="menu" color="primary" class="userMenuTrigger">{{loggedUser}}</button>
</div>
<div class="content">
  <h1>Welcome :) </h1>
  <div *ngIf="!!users">
    <div>
      Users
    </div>
    <!--      <ngx-json-viewer  [json]="users" [expanded]="true"></ngx-json-viewer>-->
    <table mat-table [dataSource]="users" class="mat-elevation-z8">

      <!-- username Column -->
      <ng-container matColumnDef="username">
        <th mat-header-cell *matHeaderCellDef> username </th>
        <td mat-cell *matCellDef="let user"> {{user.username}} </td>
      </ng-container>


      <!-- email Column -->
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef> email </th>
        <td mat-cell *matCellDef="let user"> {{user.email}} </td>
      </ng-container>

      <!-- role Column -->
      <ng-container matColumnDef="role">
        <th mat-header-cell *matHeaderCellDef> role </th>
        <td mat-cell *matCellDef="let user"> {{user.role}} </td>
      </ng-container>

      <!-- actions Column -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> actions </th>
        <td mat-cell *matCellDef="let user">
          <button mat-stroked-button color="primary" (click)="addComment(user)">comment</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>


  </div>

  <div *ngIf="!!allMovies">
    <div>
      MOVIES
    </div>

    <!--  movie table-->
    <table mat-table [dataSource]="allMovies" class="mat-elevation-z8">

      <!-- id_imdb Column -->
      <ng-container matColumnDef="id_imdb">
        <th mat-header-cell *matHeaderCellDef> id_imdb </th>
        <td mat-cell *matCellDef="let movie"> {{movie.idImdb}} </td>
      </ng-container>

      <!-- title Column -->
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef> title </th>
        <td mat-cell *matCellDef="let movie"> {{movie.title}} </td>
      </ng-container>

      <!-- year Column -->
      <ng-container matColumnDef="year">
        <th mat-header-cell *matHeaderCellDef> year </th>
        <td mat-cell *matCellDef="let movie"> {{movie.year}} </td>
      </ng-container>

      <!-- genre Column -->
      <ng-container matColumnDef="genre">
        <th mat-header-cell *matHeaderCellDef> genre </th>
        <td mat-cell *matCellDef="let movie"> {{movie.genre}} </td>
      </ng-container>

      <!-- type Column -->
      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef> type </th>
        <td mat-cell *matCellDef="let movie"> {{movie.type}} </td>
      </ng-container>

      <!-- language Column -->
      <ng-container matColumnDef="language">
        <th mat-header-cell *matHeaderCellDef> language </th>
        <td mat-cell *matCellDef="let movie"> {{movie.language}} </td>
      </ng-container>

      <!-- country Column -->
      <ng-container matColumnDef="country">
        <th mat-header-cell *matHeaderCellDef> country </th>
        <td mat-cell *matCellDef="let movie"> {{movie.country}} </td>
      </ng-container>

      <!-- averageMark Column -->
      <ng-container matColumnDef="averageMark">
        <th mat-header-cell *matHeaderCellDef> mark </th>
        <td mat-cell *matCellDef="let movie">
          <button mat-stroked-button color="primary" (click)="getAverageMarkForMovie()">average mark</button>
        </td>
      </ng-container>

      <!-- viewComments Column -->
      <ng-container matColumnDef="viewComments">
        <th mat-header-cell *matHeaderCellDef> comments </th>
        <td mat-cell *matCellDef="let movie">
          <button mat-stroked-button color="primary" (click)="getAllCommentsForMovie()">average mark</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumnsMovies"></tr>
      <tr mat-row *matRowDef="let myRow; columns: displayedColumnsMovies"></tr>
    </table>

  </div>
</div>

<mat-menu #menu>
  <button mat-menu-item (click)="getUsers()" > List all users </button>
  <button mat-menu-item (click)="getAllMovies()"> List all movies </button>
  <button mat-menu-item (click)="filterMovies()"> Filter movies </button>
  <button mat-menu-item (click)="logout()"> LOGOUT </button>
</mat-menu>
